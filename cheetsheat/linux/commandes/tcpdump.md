# INTRO
- Commandes de Base:
    * Capture de tous les paquets ───> `tcpdump`
    * Capture sur une interface spécifique ───> `tcpdump -i eth0`
    * Affichage du nombre de paquets capturés ───> `tcpdump -c 10`
    * Enregistrement des paquets dans un fichier ───> `tcpdump -w fichier.pcap`
    * Lecture des paquets depuis un fichier ───> `tcpdump -r fichier.pcap`

- Filtres:
    * Filtrer par type de protocole ───> `tcpdump icmp`, `tcpdump tcp`, `tcpdump udp`
    * Filtrer par adresse IP ───> `tcpdump src 192.168.1.1`, `tcpdump dst 192.168.1.1`
    * Filtrer par port ───> `tcpdump port 80`, `tcpdump src port 1024`
    * Filtrer par adresse et port ───> `tcpdump ip host 192.168.1.1 and tcp port 80`
    * Filtrer par réseau ───> `tcpdump net 192.168.1.0/24`

- Options Avancées:
    * Afficher les paquets en ASCII ───> `tcpdump -A`
    * Afficher les paquets en hex et ASCII ───> `tcpdump -XX`
    * Afficher le contenu des paquets en détail ───> `tcpdump -vv`
    * Ne pas convertir les adresses en noms ───> `tcpdump -n`
    * Capture avec des filtres complexes ───> `tcpdump 'tcp port 80 and (((ip[2:2] - ((ip[0]&0xf)<<2)) - ((tcp[12]&0xf0)>>2)) != 0)'`

- Exemples de Commandes:
    * Capture sur l'interface eth0, seulement les paquets TCP du port 80 ───> `tcpdump -i eth0 tcp port 80`
    * Capture de paquets ICMP incluant 4 paquets seulement ───> `tcpdump -c 4 icmp`
    * Capture et enregistrement des paquets UDP sur le port 53 (DNS) ───> `tcpdump -w dns_traffic.pcap udp port 53`

- Astuces:
    * Utilisation de tcpdump avec sudo ───> `sudo tcpdump ...` est souvent nécessaire car la capture de paquets nécessite des privilèges élevés.
    * Combinaison de filtres ───> Utiliser `and`, `or`, et `not` pour combiner des filtres, par exemple : `tcpdump 'src port 80 and (dst net 192.168.1.0/24 or dst net 10.0.2.0/24)'`.

# OPTIONS
- Options de Base:
    * `-i <interface>`───> Spécifie l'interface réseau sur laquelle écouter. Par exemple, `-i eth0`.
    * `-c <nombre>`───> Capture seulement un nombre spécifié de paquets, puis s'arrête.
    * `-w <fichier>`───> Enregistre la capture dans un fichier plutôt que de l'afficher à l'écran. Par exemple, `-w capture.pcap`.
    * `-r <fichier>`───> Lit les paquets à partir d'un fichier de capture.
    * `-D` ───> Affiche une liste des interfaces réseau disponibles.
    * `-l` ───> Met à jour la sortie en temps réel, plutôt que de la mettre en mémoire tampon. (pour pipe)

- Options pour Contrôler l'Affichage:
    * `-v`, `-vv`, `-vvv`───> Augmente la verbosité de la sortie. Plus de "v" signifie plus de détails.
    * `-A`───> Affiche chaque paquet en ASCII.
    * `-X`───> Affiche le paquet en hex et en ASCII.
    * `-XX`───> Comme `-X`, mais inclut également l'en-tête Ethernet.
    * `-n`───> Ne pas convertir les adresses (par exemple, adresses IP ou numéros de port) en noms.
    * `-S`───> Affiche les numéros de séquence TCP absolus plutôt que relatifs.

- Options Avancées:
    * `-s <taille>`───> Définit la taille de capture de chaque paquet. Par défaut, `tcpdump` tronque les paquets. `-s 0` capture la totalité de chaque paquet.
    * `-e`───> Affiche l'en-tête Ethernet dans les sorties de paquets.
    * `-q`───> Mode "quiet". Moins verbeux, affiche moins de détails.
    * `-E <clé>`───> Utilisé pour déchiffrer certains types de trafic, comme IPsec.

- Options de Performance:
    * `-B <taille>`───> Ajuste la taille du buffer de capture en kilo-octets.
    * `-C <taille>`───> Crée un nouveau fichier de capture après que le fichier actuel atteigne une certaine taille (en millions d’octets).
